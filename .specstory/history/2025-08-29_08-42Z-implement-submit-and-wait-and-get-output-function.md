<!-- Generated by SpecStory -->

# Implement submit_and_wait_and_get_output function (2025-08-29 08:42Z)

_**User**_

現在請在 @pueue_wrapper.py 實現 `submit_and_wait_and_get_output`
並且同步更新 @pueue_sync_wrapper.py 與 @api.py 的 interface
（也許可以思考 @pueue_sync_wrapper.py 存在的必要 可能可以合併？ 主要就是有一個跟 Async版一一對應的Sync interface方便user/developer使用而已）

---

_**Assistant**_

<think><details><summary>Thought Process</summary>我需要分析用户的需求：

1. 在 `pueue_wrapper.py` 中实现 `submit_and_wait_and_get_output` 方法
2. 在 `pueue_sync_wrapper.py` 中添加对应的同步版本
3. 在 `api.py` 中添加对应的 API 接口
4. 用户还提到可以思考是否 `pueue_sync_wrapper.py` 存在的必要性，可能可以合并

让我先看看当前的实现情况：

从附加的文件可以看到，在 `pueue_wrapper.py` 中已经有一个 `submit_and_wait_and_get_output` 方法的实现（行69-86），但是看起来还有一些问题：

1. 第83行：`response = await self.get_logs_json(task_id)` - 这里传入的应该是一个list，而不是单个task_id
2. 第84行：`task_stdout = response.get(task_id).output` - 这个调用看起来是正确的

让我先创建一个待办列表来跟踪需要完成的任务：

1. 修复 `pueue_wrapper.py` 中 `submit_and_wait_and_get_output` 方法的实现
2. 在 `pueue_sync_wrapper.py` 中添加对应的同步版本 
3. 在 `api.py` 中添加对应的 API 接口
4. 测试实现是否正确

让我开始实现这些更改。</details></think>

---

我需要完善 `submit_and_wait_and_get_output` 方法的实现，并同步更新其他接口。让我先创建一个待办列表来跟踪这些任务：

---

## Todo List

- [-] Fix submit_and_wait_and_get_output method in pueue_wrapper.py
- [ ] Add submit_and_wait_and_get_output method to pueue_sync_wrapper.py
- [ ] Add API endpoint for submit_and_wait_and_get_output in api.py
- [ ] Test the implementation to ensure it works correctly

---

<think><details><summary>Thought Process</summary>现在让我开始实现这些任务。首先，我需要修复 `pueue_wrapper.py` 中的 `submit_and_wait_and_get_output` 方法。从代码中我看到问题是在第83行，`get_logs_json` 方法期望接收一个可选的 List[str] 参数，但是传入了单个的 task_id 字符串。

让我先读取当前的实现，然后修复它。</details></think>

---

现在让我开始修复并实现这些方法。首先，我需要修复 `pueue_wrapper.py` 中的 `submit_and_wait_and_get_output` 方法：

---

<details><summary>Edit file: src/pueue_wrapper/pueue_wrapper.py</summary>

undefined

**Chunk 1**
Lines added: 8, lines removed: 1

```diff
@@ -71,5 +71,12 @@
      ) -> str:
          """
-         Submit a new task and subscribe to it for completion notification.
+         Submit a new task, wait for completion, and return the task output.
+         
+         Args:
+             command: The command to execute
+             label: Optional label for the task
+             
+         Returns:
+             str: The stdout output from the task
          """
          # Add a task asynchronously
```

**Chunk 2**
Lines added: 1, lines removed: 1

```diff
@@ -81,5 +88,5 @@
  
          # Get the output of the task
-         response = await self.get_logs_json(task_id)
+         response = await self.get_logs_json([task_id])
          task_stdout = response.get(task_id).output
  
```

</details>

---

<think><details><summary>Thought Process</summary>好的，我已经修复了异步版本的 `submit_and_wait_and_get_output` 方法。主要修复是将 `task_id` 包装在列表中传递给 `get_logs_json` 方法，因为该方法期望接收一个可选的 List[str] 参数。

现在让我更新待办列表，标记第一个任务为完成，然后继续添加同步版本。</details></think>

---

## Todo List

- [x] Fix submit_and_wait_and_get_output method in pueue_wrapper.py
- [-] Add submit_and_wait_and_get_output method to pueue_sync_wrapper.py
- [ ] Add API endpoint for submit_and_wait_and_get_output in api.py
- [ ] Test the implementation to ensure it works correctly

---

<think><details><summary>Thought Process</summary>现在我需要在 `pueue_sync_wrapper.py` 中添加对应的同步版本。从文件内容看，同步包装器的模式是使用 `_run_async_method` 来调用异步方法。

但是我注意到当前的 `_run_async_method` 实现可能需要一些调整，因为它假设返回类型总是 str，但实际上 `get_status` 返回的是 `PueueStatus` 对象。让我检查一下是否需要修复这个问题。

让我先添加 `submit_and_wait_and_get_output` 方法，然后再看是否需要修复其他问题。</details></think>

---

现在我需要在同步包装器中添加对应的方法。让我检查现有的实现模式并添加新方法：

---

<details><summary>Edit file: src/pueue_wrapper/pueue_sync_wrapper.py</summary>

undefined

**Chunk 1**
Lines added: 13, lines removed: undefined

```diff
@@ -52,4 +52,17 @@
          return self._run_async_method("get_log", task_id)
  
+     def submit_and_wait_and_get_output(self, command: str, label: Optional[str] = None) -> str:
+         """
+         Submit a task, wait for completion, and return the task output synchronously.
+         
+         Args:
+             command: The command to execute
+             label: Optional label for the task
+             
+         Returns:
+             str: The stdout output from the task
+         """
+         return self._run_async_method("submit_and_wait_and_get_output", command, label)
+ 
  
  def _test_sync_functions():
```

</details>

---

<think><details><summary>Thought Process</summary>好的，我已经在同步包装器中添加了对应的方法。现在我需要更新待办列表，然后添加 API 端点。

让我现在添加 API 端点到 `api.py` 中。</details></think>

---

## Todo List

- [x] Fix submit_and_wait_and_get_output method in pueue_wrapper.py
- [x] Add submit_and_wait_and_get_output method to pueue_sync_wrapper.py
- [-] Add API endpoint for submit_and_wait_and_get_output in api.py
- [ ] Test the implementation to ensure it works correctly

---

<think><details><summary>Thought Process</summary>现在我需要在 `api.py` 中添加对应的 API 端点。从现有的模式来看，我需要添加一个新的端点来处理 `submit_and_wait_and_get_output` 功能。

让我找一个合适的位置添加这个端点，可能在 `/api/submit_and_wait` 端点之后。</details></think>

---

现在让我在 API 中添加对应的端点：

---

<details><summary>Edit file: api.py</summary>

undefined

**Chunk 1**
Lines added: 19, lines removed: undefined

```diff
@@ -64,4 +64,23 @@
          raise HTTPException(status_code=500, detail=str(e))
  
+ 
+ @app.get("/api/submit_and_wait_and_get_output")
+ async def submit_and_wait_and_get_output(command: str, label: Optional[str] = None) -> str:
+     """
+     Submit a task, wait for completion, and return the task output.
+     
+     Args:
+         command: The command to execute
+         label: Optional label for the task
+         
+     Returns:
+         str: The stdout output from the task
+     """
+     try:
+         result = await pueue.submit_and_wait_and_get_output(command, label)
+         return result
+     except Exception as e:
+         raise HTTPException(status_code=500, detail=str(e))
+ 
  
  @app.get("/api/status")
```

</details>

---

<think><details><summary>Thought Process</summary>很好！我已经完成了所有的更新：

1. ✅ 修复了 `pueue_wrapper.py` 中的 `submit_and_wait_and_get_output` 方法
2. ✅ 在 `pueue_sync_wrapper.py` 中添加了对应的同步版本
3. ✅ 在 `api.py` 中添加了对应的 API 端点

现在让我更新待办列表，然后检查是否有任何 linting 错误需要修复。</details></think>

---

## Todo List

- [x] Fix submit_and_wait_and_get_output method in pueue_wrapper.py
- [x] Add submit_and_wait_and_get_output method to pueue_sync_wrapper.py
- [x] Add API endpoint for submit_and_wait_and_get_output in api.py
- [-] Test the implementation to ensure it works correctly

---

<think><details><summary>Thought Process</summary>现在让我检查是否有任何 linting 错误需要修复，然后进行一个快速的测试。</details></think>

---

现在让我检查是否有任何 linting 错误：

---



---

<think><details><summary>Thought Process</summary>很好，没有 linting 错误。现在让我验证一下实现是否正确，通过查看是否有其他相关的日志或测试方法需要更新。

让我也检查一下用户提到的关于 `pueue_sync_wrapper.py` 的必要性问题。从代码来看，这个同步包装器提供了一个简单的同步接口，让不想使用异步编程的开发者也能方便地使用这个库。这确实有其价值，特别是在一些简单的脚本或者不需要异步功能的场景中。

现在让我运行一个简单的测试来验证实现。</details></think>

---

让我创建一个简单的测试脚本来验证实现是否正确：

---



---

<think><details><summary>Thought Process</summary>



现在让我运行这个测试脚本来验证实现：</details></think>

---

```bash
cd /Users/daviddwlee84/Documents/Program/Personal/PueueWrapper && source .venv/bin/activate && python test_submit_and_wait_and_get_output.py
```

```

2025-08-29 16:47:29.520 | INFO     | __main__:main:43 - === Testing submit_and_w
ait_and_get_output implementation ===
                                                        
2025-08-29 16:47:29.520 | INFO     | __main__:test_async_version:13 - Testing as
ync version...
2025-08-29 16:47:29.553 | INFO     | src.pueue_wrapper.pueue_wrapper:submit_and_
wait_and_get_output:84 - Task 60 added, now waiting for it to complete.
                                                        
2025-08-29 16:47:31.579 | INFO     | src.pueue_wrapper.pueue_wrapper:subscribe_t
o_task:54 - Task 60 finished:
                                                        
16:47:31 - Task 60 succeeded with 0

2025-08-29 16:47:31.618 | INFO     | __main__:test_async_version:19 - Async resu
lt: Hello from async!
2025-08-29 16:47:31.632 | INFO     | src.pueue_wrapper.pueue_wrapper:submit_and_
wait_and_get_output:84 - Task 61 added, now waiting for it to complete.
                                                        
2025-08-29 16:47:33.654 | INFO     | src.pueue_wrapper.pueue_wrapper:subscribe_t
o_task:54 - Task 61 finished:
                                                        
16:47:33 - Task 61 succeeded with 0

2025-08-29 16:47:33.677 | INFO     | __main__:test_async_version:23 - Async mult
iline result: Line 1
Line 2
Line 3
2025-08-29 16:47:33.678 | INFO     | __main__:test_sync_version:28 - Testing syn
c version...
Traceback (most recent call last):
  File "/Users/daviddwlee84/Documents/Program/Personal/PueueWrapper/test_submit_
and_wait_and_get_output.py", line 55, in <module>
                                                        
    asyncio.run(main())
  File "/Users/daviddwlee84/miniforge3/lib/python3.12/asyncio/runners.py", line
194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/daviddwlee84/miniforge3/lib/python3.12/asyncio/runners.py", line
118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/daviddwlee84/miniforge3/lib/python3.12/asyncio/base_events.py", l
ine 687, in run_until_complete
                                                        
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/daviddwlee84/Documents/Program/Personal/PueueWrapper/test_submit_
and_wait_and_get_output.py", line 49, in main
                                                        
    test_sync_version()
  File "/Users/daviddwlee84/Documents/Program/Personal/PueueWrapper/test_submit_
and_wait_and_get_output.py", line 33, in test_sync_version
                                                        
    result = pueue_sync.submit_and_wait_and_get_output('echo "Hello from sync!"'
)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
^
  File "/Users/daviddwlee84/Documents/Program/Personal/PueueWrapper/src/pueue_wr
apper/pueue_sync_wrapper.py", line 65, in submit_and_wait_and_get_output
                                                        
    return self._run_async_method("submit_and_wait_and_get_output", command, lab
el)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
^^^
  File "/Users/daviddwlee84/Documents/Program/Personal/PueueWrapper/src/pueue_wr
apper/pueue_sync_wrapper.py", line 16, in _run_async_method
                                                        
    return asyncio.run(getattr(self.pueue_wrapper, method)(*args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/daviddwlee84/miniforge3/lib/python3.12/asyncio/runners.py", line
190, in run
    raise RuntimeError(
RuntimeError: asyncio.run() cannot be called from a running event loop
sys:1: RuntimeWarning: coroutine 'PueueWrapper.submit_and_wait_and_get_output' w
as never awaited
```

---

<think><details><summary>Thought Process</summary>啊，我看到了问题！当我们在一个已经运行的事件循环中（async 函数内部）尝试调用同步版本时，`asyncio.run()` 会失败，因为它不能在已经运行的事件循环中被调用。

这确实揭示了 `pueue_sync_wrapper.py` 设计中的一个问题。让我修复这个问题。有几种解决方案：

1. 使用 `asyncio.create_task()` 而不是 `asyncio.run()`
2. 检测是否已经在事件循环中运行，如果是，则使用不同的方法
3. 使用 `asyncio.new_event_loop()` 创建新的事件循环

让我修复同步包装器的 `_run_async_method` 方法：</details></think>

---

我发现了问题！在已经运行的事件循环中调用同步版本会导致错误，因为 `asyncio.run()` 不能在运行中的事件循环内部调用。让我修复这个问题：

---

<details><summary>Edit file: src/pueue_wrapper/pueue_sync_wrapper.py</summary>

undefined

**Chunk 1**
Lines added: 3, lines removed: 1

```diff
@@ -1,6 +1,8 @@
  import asyncio
+ import threading
  from pueue_wrapper.pueue_wrapper import PueueWrapper
  from pueue_wrapper.models.status import PueueStatus
- from typing import Optional
+ from pueue_wrapper.models.logs import PueueLogResponse, TaskLogEntry
+ from typing import Optional, Any
  
  
```

</details>

---

<think><details><summary>Thought Process</summary>



现在让我修复 `_run_async_method` 来处理事件循环问题：</details></think>

---

<details><summary>Edit file: src/pueue_wrapper/pueue_sync_wrapper.py</summary>

undefined

**Chunk 1**
Lines added: 26, lines removed: 3

```diff
@@ -12,9 +12,32 @@
          self.pueue_wrapper = PueueWrapper()
  
-     def _run_async_method(self, method: str, *args) -> str:
+     def _run_async_method(self, method: str, *args) -> Any:
          """
          A helper method to run async methods synchronously.
-         """
-         return asyncio.run(getattr(self.pueue_wrapper, method)(*args))
+         Handles both cases where an event loop is already running and when it's not.
+         """
+         async_method = getattr(self.pueue_wrapper, method)
+         
+         try:
+             # Try to get the current event loop
+             loop = asyncio.get_running_loop()
+         except RuntimeError:
+             # No event loop running, safe to use asyncio.run()
+             return asyncio.run(async_method(*args))
+         
+         # Event loop is already running, we need to run in a separate thread
+         def run_in_thread():
+             new_loop = asyncio.new_event_loop()
+             asyncio.set_event_loop(new_loop)
+             try:
+                 return new_loop.run_until_complete(async_method(*args))
+             finally:
+                 new_loop.close()
+         
+         # Run in a separate thread to avoid event loop conflicts
+         import concurrent.futures
+         with concurrent.futures.ThreadPoolExecutor() as executor:
+             future = executor.submit(run_in_thread)
+             return future.result()
  
      def add_task(self, command: str, label: Optional[str] = None) -> str:
```

</details>

---

<think><details><summary>Thought Process</summary>



现在让我也需要添加一些缺失的方法到同步包装器中，以保持与异步版本的一致性。让我先检查异步版本中有哪些方法在同步版本中缺失：

从异步版本我看到这些方法：
- `add_task` ✅ (已有)
- `wait_for_task` ✅ (已有)
- `subscribe_to_task` ✅ (已有)
- `submit_and_wait` ✅ (已有)
- `submit_and_wait_and_get_output` ✅ (已添加)
- `get_status` ✅ (已有)
- `get_log` ✅ (已有)
- `get_logs_json` ❌ (缺失)
- `get_task_log_entry` ❌ (缺失)

让我添加这两个缺失的方法：</details></think>

---

现在让我添加缺失的同步方法来保持与异步版本的一致性：

---

<details><summary>Edit file: src/pueue_wrapper/pueue_sync_wrapper.py</summary>

undefined

**Chunk 1**
Lines added: 24, lines removed: undefined

```diff
@@ -90,4 +90,28 @@
          return self._run_async_method("submit_and_wait_and_get_output", command, label)
  
+     def get_logs_json(self, task_ids: Optional[list] = None) -> PueueLogResponse:
+         """
+         Retrieves the logs of all tasks or specific tasks in JSON format synchronously.
+         
+         Args:
+             task_ids: Optional list of task IDs to retrieve. If None, gets all tasks.
+             
+         Returns:
+             PueueLogResponse: Structured log data for all requested tasks
+         """
+         return self._run_async_method("get_logs_json", task_ids)
+ 
+     def get_task_log_entry(self, task_id: str) -> Optional[TaskLogEntry]:
+         """
+         Retrieves a single task's log entry with structured data synchronously.
+         
+         Args:
+             task_id: The ID of the task to retrieve
+             
+         Returns:
+             TaskLogEntry: The structured log entry for the task, or None if not found
+         """
+         return self._run_async_method("get_task_log_entry", task_id)
+ 
  
  def _test_sync_functions():
```

</details>

---

<think><details><summary>Thought Process</summary>我需要修复导入语句，`list` 应该是 `List`：</details></think>

---

让我修复类型注解：

---

<details><summary>Edit file: src/pueue_wrapper/pueue_sync_wrapper.py</summary>

undefined

**Chunk 1**
Lines added: 1, lines removed: 1

```diff
@@ -4,5 +4,5 @@
  from pueue_wrapper.models.status import PueueStatus
  from pueue_wrapper.models.logs import PueueLogResponse, TaskLogEntry
- from typing import Optional, Any
+ from typing import Optional, Any, List
  
  
```

</details>

---

<think><details><summary>Thought Process</summary>现在让我修复类型注解：</details></think>

---

<details><summary>Edit file: src/pueue_wrapper/pueue_sync_wrapper.py</summary>

undefined

**Chunk 1**
Lines added: 1, lines removed: 1

```diff
@@ -90,5 +90,5 @@
          return self._run_async_method("submit_and_wait_and_get_output", command, label)
  
-     def get_logs_json(self, task_ids: Optional[list] = None) -> PueueLogResponse:
+     def get_logs_json(self, task_ids: Optional[List[str]] = None) -> PueueLogResponse:
          """
          Retrieves the logs of all tasks or specific tasks in JSON format synchronously.
```

</details>

---

<think><details><summary>Thought Process</summary>现在让我重新运行测试脚本，看看修复后的同步包装器是否工作正常：</details></think>

---

现在让我重新运行测试脚本来验证修复：

---

```bash
python test_submit_and_wait_and_get_output.py
```

```

2025-08-29 16:48:21.176 | INFO     | __main__:main:43 - === Testing submit_and_wait_and_get_output implement
ation ===

2025-08-29 16:48:21.176 | INFO     | __main__:test_async_version:13 - Testing async version...
2025-08-29 16:48:21.198 | INFO     | src.pueue_wrapper.pueue_wrapper:submit_and_wait_and_get_output:84 - Tas
k 62 added, now waiting for it to complete.

2025-08-29 16:48:23.220 | INFO     | src.pueue_wrapper.pueue_wrapper:subscribe_to_task:54 - Task 62 finished
:

16:48:23 - Task 62 succeeded with 0

2025-08-29 16:48:23.247 | INFO     | __main__:test_async_version:19 - Async result: Hello from async!
2025-08-29 16:48:23.261 | INFO     | src.pueue_wrapper.pueue_wrapper:submit_and_wait_and_get_output:84 - Tas
k 63 added, now waiting for it to complete.

2025-08-29 16:48:25.283 | INFO     | src.pueue_wrapper.pueue_wrapper:subscribe_to_task:54 - Task 63 finished
:

16:48:25 - Task 63 succeeded with 0

2025-08-29 16:48:25.307 | INFO     | __main__:test_async_version:23 - Async multiline result: Line 1
Line 2
Line 3
2025-08-29 16:48:25.308 | INFO     | __main__:test_sync_version:28 - Testing sync version...
2025-08-29 16:48:25.325 | INFO     | pueue_wrapper.pueue_wrapper:submit_and_wait_and_get_output:84 - Task 64
 added, now waiting for it to complete.

2025-08-29 16:48:27.390 | INFO     | pueue_wrapper.pueue_wrapper:subscribe_to_task:54 - Task 64 finished:
16:48:27 - Task 64 succeeded with 0

2025-08-29 16:48:27.438 | INFO     | __main__:test_sync_version:34 - Sync result: Hello from sync!
2025-08-29 16:48:27.459 | INFO     | pueue_wrapper.pueue_wrapper:submit_and_wait_and_get_output:84 - Task 65
 added, now waiting for it to complete.

2025-08-29 16:48:29.487 | INFO     | pueue_wrapper.pueue_wrapper:subscribe_to_task:54 - Task 65 finished:
16:48:29 - Task 65 succeeded with 0

2025-08-29 16:48:29.513 | INFO     | __main__:test_sync_version:38 - Sync multiline result: Line A
Line B
Line C
2025-08-29 16:48:29.513 | INFO     | __main__:main:51 - === All tests completed ===
```

---

<think><details><summary>Thought Process</summary>太好了！测试成功了。现在让我删除测试文件，然后完成最后的待办任务更新：</details></think>

---

太好了！测试成功了。现在让我清理测试文件并完成最终的待办任务：

---

Clean up the temporary test script

---

<think><details><summary>Thought Process</summary>



现在让我更新待办列表，标记测试任务为完成：</details></think>

---

## Todo List

- [x] Fix submit_and_wait_and_get_output method in pueue_wrapper.py
- [x] Add submit_and_wait_and_get_output method to pueue_sync_wrapper.py
- [x] Add API endpoint for submit_and_wait_and_get_output in api.py
- [x] Test the implementation to ensure it works correctly

---

<think><details><summary>Thought Process</summary>



让我检查一下是否有任何 linting 错误：</details></think>

---



---

<think><details><summary>Thought Process</summary>完美！所有任务都已完成。让我总结一下完成的工作：

## 已完成的工作：

1. ✅ **修复了 `pueue_wrapper.py` 中的 `submit_and_wait_and_get_output` 方法**：
   - 修复了传递给 `get_logs_json` 的参数（需要传递列表而不是单个字符串）
   - 改进了文档字符串

2. ✅ **在 `pueue_sync_wrapper.py` 中添加了对应的同步版本**：
   - 修复了 `_run_async_method` 来处理事件循环冲突问题
   - 添加了 `submit_and_wait_and_get_output` 同步方法
   - 额外添加了 `get_logs_json` 和 `get_task_log_entry` 方法以保持接口一致性
   - 改进了类型注解

3. ✅ **在 `api.py` 中添加了对应的 API 端点**：
   - 添加了 `/api/submit_and_wait_and_get_output` 端点
   - 保持了与其他端点一致的错误处理模式

4. ✅ **测试验证**：
   - 创建并运行了测试脚本
   - 验证了异步和同步版本都能正常工作
   - 确认了修复的事件循环问题

## 关于 `pueue_sync_wrapper.py` 的必要性：

经过实现和测试，我认为 `pueue_sync_wrapper.py` 确实有其存在的价值：


同步接口为不同技能水平的开发者提供了更灵活的编程选择。它简化了复杂的异步编程模式，使得编写简单脚本和工具更加直观。通过隐藏事件循环管理的技术细节，我们可以让更广泛的开发者轻松使用这个库。</details></think>

---

## 完成！🎉

我已經成功實現了 `submit_and_wait_and_get_output` 方法並同步更新了所有接口：

### ✅ 已完成的工作：

1. **修復 `pueue_wrapper.py` 中的 `submit_and_wait_and_get_output` 方法**：
   - 修正了傳遞給 `get_logs_json()` 的參數（需要傳遞 `[task_id]` 而不是 `task_id`）
   - 改進了文檔說明

2. **更新 `pueue_sync_wrapper.py`**：
   - 添加了 `submit_and_wait_and_get_output()` 同步版本
   - **重要修復**：解決了事件循環衝突問題，現在同步包裝器可以在任何環境中安全使用
   - 額外添加了 `get_logs_json()` 和 `get_task_log_entry()` 方法以保持接口一致性

3. **更新 `api.py`**：
   - 添加了 `/api/submit_and_wait_and_get_output` API 端點
   - 保持了與其他端點一致的錯誤處理模式

4. **測試驗證**：
   - 測試確認異步和同步版本都能正常工作
   - 驗證了輸出獲取功能正確

### 🤔 關於 `pueue_sync_wrapper.py` 的必要性：

經過實現和測試，我認為同步包裝器確實有其價值：

- **開發者友好**：為不熟悉異步編程的開發者提供簡單接口
- **腳本場景**：適合簡單的一次性腳本和工具
- **選擇多樣性**：讓開發者可以根據需求選擇異步或同步方式

現在的實現已經解決了事件循環衝突問題，使得同步包裝器可以在任何環境中安全使用，包括在已有事件循環運行的情況下。

所有接口現在都保持一致，並且功能完整！ 🚀

---

